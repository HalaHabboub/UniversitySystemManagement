@{
    ViewData["Title"] = "Set User Role";
    var currentRoles = ViewBag.CurrentRoles as IList<string>;
    var allRoles = ViewBag.AllRoles as List<string>;
}

<h1>Set Role</h1>
<hr />

<h4>User: @ViewBag.UserEmail</h4>

<p>
    <strong>Current Role(s):</strong>
    @if (currentRoles != null && currentRoles.Any())
    {
        @string.Join(", ", currentRoles)
    }
    else
    {
        <span class="text-muted">None</span>
    }
</p>

<!-- Role selection form -->
<form asp-action="SetRole" method="post">
    @Html.AntiForgeryToken()
    <input type="hidden" name="userId" value="@ViewBag.UserId" />

    <div class="form-group mb-3">
        <label class="control-label">Select New Role</label>
        <select name="role" class="form-control" style="max-width: 300px;">
            <option value="">-- No Role --</option>
            @if (allRoles != null)
            {
                @foreach (var role in allRoles)
                {
                    <option value="@role">@role</option>
                }
            }
        </select>
    </div>

    <button type="submit" class="btn btn-primary">Save Role</button>
    <a asp-action="Users" class="btn btn-secondary">Cancel</a>
</form>
